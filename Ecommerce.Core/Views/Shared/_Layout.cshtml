<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Ecommerce.Core</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/Ecommerce.Core.styles.css" asp-append-version="true" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
</head>

<body>

    <div class="min-vh-100 d-flex flex-column">
        <main class="flex-grow-1 bg-lightblue d-flex flex-column justify-content-center align-items-center">
            @RenderBody()
        </main>
    </div>
    <partial name="_LogoutModalPartial" />


    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/6.0.0/signalr.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    <script>
        const themes = ['system', 'light', 'dark'];
        const icons = ['bi-circle-half', 'bi-sun', 'bi-moon'];
        const titles = ['System Theme', 'Light Theme', 'Dark Theme'];

        setTheme(currentTheme);

        function setTheme(theme) {

            if (theme === 'system') {
                $('html').removeAttr('data-theme');
            } else {
                $('html').attr('data-theme', theme);
            }

            const index = themes.indexOf(theme);

            $('.theme-icon')
                .removeClass('bi-circle-half bi-sun bi-moon')
                .addClass(icons[index])
                .attr('data-theme', theme)
                .attr('title', titles[index]);

        }

        $('.theme-toggle').on('click', '.theme-icon', function () {
            const currentIndex = themes.indexOf($(this).attr('data-theme'));
            const nextTheme = themes[(currentIndex + 1) % themes.length];
            setTheme(nextTheme);
        });

        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
            if (localStorage.getItem('theme') === 'system') {
                console.log('System theme changed to:', e.matches ? 'dark' : 'light');
            }
        });
    </script>
    <partial name="_ValidationScriptsPartial" />

    @await RenderSectionAsync("Scripts", required: false)
</body>

</html>
